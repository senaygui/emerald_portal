<!-- Redesigned certificate to match the provided image style -->
<% provide(:title, @graduate_student.full_name) %>
<style>
  @page { size: A4; margin: 18mm; }
  body { font-family: 'Georgia', serif; color: #0a2342; }

  .frame {
    position: relative;
    padding: 22mm 18mm;
    min-height: 245mm;
    border: 4px solid #d6b35f; /* gold outer */
    box-shadow: inset 0 0 0 6px #fff, inset 0 0 0 10px #d6b35f; /* double border */
  }

  /* Ribbons */
  .ribbon-top-left {
    position: absolute; left: -12mm; top: 10mm; width: 95mm; height: 22mm;
    background: linear-gradient(135deg, #0a51b7 0%, #0b3c95 60%, #083070 100%);
    transform: skewX(-30deg);
  }
  .ribbon-top-left::after {
    content: ''; position: absolute; left: 40mm; top: 16mm; width: 58mm; height: 10mm;
    background: #f0b310; transform: skewX(-30deg);
  }
  .ribbon-bottom-right {
    position: absolute; right: -12mm; bottom: 10mm; width: 95mm; height: 18mm;
    background: linear-gradient(135deg, #0a51b7 0%, #0b3c95 60%, #083070 100%);
    transform: skewX(-30deg);
  }
  .ribbon-bottom-right::after {
    content: ''; position: absolute; right: 36mm; bottom: -6mm; width: 58mm; height: 8mm;
    background: #f0b310; transform: skewX(-30deg);
  }

  .header { text-align: center; margin-bottom: 6mm; }
  .brand-row { display: flex; justify-content: center; gap: 8mm; margin-bottom: 2mm; }
  .brand-row img { height: 18mm; }
  .logo-badge { display: inline-block; background: #fff; padding: 4mm 6mm; border-radius: 6mm; box-shadow: 0 2px 6px rgba(0,0,0,0.25); margin-bottom: 2mm; }
  .logo-badge img { height: 14mm; vertical-align: middle; margin: 0 2mm; }
  .title { font-size: 28pt; color: #0a2f6b; font-weight: 900; text-align: center; margin: 6mm 0 6mm; }

  .student-name { text-align: center; font-size: 16pt; font-weight: 800; letter-spacing: .6px; text-transform: uppercase; margin: 2mm 0 0.5mm; }
  .divider { height: 2px; background: #000; width: 70%; margin: 2mm auto 6mm; }
  .paragraph { text-align: center; font-size: 11.5pt; line-height: 1.6; margin: 0 auto 6mm; width: 92%; }

  .label { font-weight: 700; color: #0a2342; }
  .category { width: 90%; margin: 2mm auto; font-size: 11pt; }
  .category strong { color: #0a51b7; text-decoration: underline; }
  .course-list { width: 86%; margin: 2mm auto 8mm; font-size: 11pt; }
  .course-list ul { margin: 2mm 0 0 10mm; padding: 0; }
  .course-list li { margin: 2mm 0; font-weight: 800; font-style: italic; list-style-type: disc; }

  .sign-row { width: 90%; margin: 12mm auto 0; display: flex; justify-content: space-between; font-size: 10pt; color: #333; }
  .sign-col { width: 48%; text-align: center; }
  .sign-line { border-top: 1px solid #333; margin: 12mm 0 2mm; }
  .date { text-align: center; margin-top: 2mm; font-size: 10.5pt; }
</style>

<%# Data preparation %>
<% program_name = @graduate_student&.program&.program_name %>
<% last_attended = @graduate_student&.fully_attended_date || @graduate_student&.updated_at %>
<% sc = (@graduate_student.respond_to?(:student_courses) ? @graduate_student.student_courses : []) %>
<% courses = sc.map { |row| row.try(:course_title) }.compact.presence || (
      (@graduate_student.respond_to?(:courses) ? @graduate_student.courses : []).map { |c| c.try(:course_title) || c.try(:course_name) }.compact
    ) %>

<div class="frame">
  <div class="ribbon-top-left"></div>
  <div class="ribbon-bottom-right"></div>

  <div class="header">
    <br><br>
    <div class="logo-badge">
      <%# Replace with the three small logos if available: e.g., nufart.png, kue.png, aaeb.png %>
      
      <%= image_tag wicked_pdf_asset_base64('logo-emerald.png'), alt: 'NUF', style: 'height:14mm' rescue nil %>
      <%#= image_tag wicked_pdf_asset_base64('kue.png'), alt: 'KUE' %>
      <%#= image_tag wicked_pdf_asset_base64('aaeb.png'), alt: 'AAEB' %>
    </div>
    <div class="title">Certificate of Innovative Pedagogy</div>
  </div>

  <div class="student-name"><%= @graduate_student.full_name %></div>
  <div class="divider"></div>

  <div class="paragraph">
    <strong>Has successfully</strong> completed a <strong>Six‑Month Innovative Pedagogy Training</strong>,
    offered by <strong>Kotebe University of Education</strong> (30% Face‑to‑Face) and
    <strong>Emerald International College Research and Training Institute</strong> (70% Online Learning).
  </div>

  <div class="category"><span class="label">Category:</span> <strong><%= program_name %></strong></div>

  <div class="course-list">
    <div class="label">List of course completed:</div>
    <% if courses.present? %>
      <ul>
        <% courses.each do |c| %>
          <li><%= c %></li>
        <% end %>
      </ul>
    <% else %>
      <div>—</div>
    <% end %>
  </div>

  <div class="date"><%= last_attended.present? ? last_attended.strftime('%b, %Y') : '' %></div>

  <div class="sign-row">
    <div class="sign-col">
      <div class="sign-line"></div>
      Kotebe University of Education
    </div>
    <div class="sign-col">
      <div class="sign-line"></div>
      Emerald International College Research and Training Institute
    </div>
  </div>
</div>

